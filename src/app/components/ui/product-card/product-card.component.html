<article class="group relative flex flex-col mt-[80px] rounded-2xl border border-[#2a2f5b] bg-[radial-gradient(circle,hsl(231_55%_15%),#0d102a_70%)] transition-all duration-300 hover:-translate-y-3 hover:shadow-2xl hover:shadow-primary-accent/30">

  <div
    class="absolute -inset-px rounded-2xl border-2 border-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"
    style="background: linear-gradient(145deg, var(--color-primary-accent), transparent 30%, transparent 70%, var(--color-secondary-accent)) border-box;
           -webkit-mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
           mask: linear-gradient(#fff 0 0) padding-box, linear-gradient(#fff 0 0);
           -webkit-mask-composite: destination-out;
           mask-composite: exclude;">
  </div>

  <div class="absolute -top-[80px] left-1/2 -translate-x-1/2 w-[90%] aspect-[3/2] flex items-center justify-center z-10">
    <img
      [ngSrc]="product.imageUrl"
      [alt]="'[Imagen de ' + product.name + ']'"
      width="400"
      height="267"
      class="max-w-full max-h-full object-contain transition-all duration-500 ease-in-out group-hover:scale-110 group-hover:-translate-y-2 group-hover:blur-sm h-auto"
      style="filter: drop-shadow(0 10px 15px rgba(0,0,0,0.4));"
    >
  </div>

  <div class="relative flex flex-col flex-grow text-center p-6 pt-[130px]">
    <div class="flex justify-center gap-2 mb-2">
      @for(tag of product.tags; track tag) {
        <span class="bg-white/10 text-text-on-dark text-xs font-semibold px-3 py-1 rounded-full">{{ tag }}</span>
      }
    </div>

    <h3 class="text-white font-semibold text-lg leading-tight min-h-[50px]">{{ product.name }}</h3>

    <div class="flex flex-col items-center mt-auto pt-2">
      @if(product.oldPrice) {
        <span class="text-[#a9a9d1] text-base line-through">${{ product.oldPrice }}</span>
      }
      <span class="text-secondary-accent text-3xl font-bold">${{ product.price }}</span>
    </div>
  </div>

  <div class="absolute inset-0 z-20 bg-[#0f0f28]/60 backdrop-blur-md backdrop-saturate-120 rounded-2xl opacity-0 transition-opacity duration-500 group-hover:opacity-100 flex flex-col justify-center items-center p-6 pointer-events-none group-hover:pointer-events-auto">
    <button
      (click)="toggleCompare()"
      [ngClass]="{
        'bg-secondary-accent text-dark-bg': isComparing(),
        'bg-black/30 text-white': !isComparing()
      }"
      class="absolute top-4 right-4 w-9 h-9 rounded-full flex items-center justify-center border border-white/20 transition-all hover:shadow-neon-primary">
      <i class="fas fa-balance-scale"></i>
    </button>
    <div class="flex gap-4 mb-8">
      @for(spec of product.specs; track spec.name) {
        <div class="flex flex-col items-center text-center w-20 opacity-0 transition-all duration-300 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0" [style.transition-delay]="spec.delay">
          <div class="w-6 h-6 mb-2 text-text-secondary">
            <app-icon [path]="spec.iconPath ?? ''"></app-icon>
          </div>
          <span class="text-text-on-dark text-sm font-medium leading-tight">{{ spec.name }}</span>
        </div>
      }
    </div>
    <button (click)="addToCart()" class="w-[80%] bg-primary-accent text-white font-bold py-3 rounded-lg opacity-0 transition-all duration-300 translate-y-4 group-hover:opacity-100 group-hover:translate-y-0 hover:bg-primary-accent-darker hover:shadow-neon-primary" style="transition-delay: 400ms;">
      AÃ±adir al Carrito
    </button>
  </div>
</article>
