<header class="flex justify-between items-center">
  <h1 class="text-2xl sm:text-3xl font-bold">Gesti√≥n de Pedidos</h1>
</header>

<div class="bg-dark-bg-secondary border border-border-color rounded-xl overflow-x-auto mt-8">
  <table class="w-full border-collapse">
    <thead>
      <tr>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase whitespace-nowrap">Pedido #</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase whitespace-nowrap">Cliente</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase whitespace-nowrap">Fecha</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase whitespace-nowrap">Total</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase whitespace-nowrap">Estado</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase whitespace-nowrap">Acciones</th>
      </tr>
    </thead>
    <tbody>
      @if (isLoading()) {
        @for (_ of [1,2,3,4]; track $index) {
          <tr class="last:border-b-0">
            @for (_ of [1,2,3,4,5,6]; track $index) {
              <td class="p-4 text-left border-b border-border-color"><div class="w-full h-4 bg-border-color rounded animate-pulse"></div></td>
            }
          </tr>
        }
      } @else {
        @for (order of orders(); track order.id) {
          <tr class="last:border-b-0">
            <td class="p-4 text-left border-b border-border-color font-semibold text-white">{{ order.id }}</td>
            <td class="p-4 text-left border-b border-border-color">{{ order.customerName }}</td>
            <td class="p-4 text-left border-b border-border-color">{{ order.date | date: 'dd MMM, yyyy' }}</td>
            <td class="p-4 text-left border-b border-border-color">${{ order.total.toFixed(2) }}</td>
            <td class="p-4 text-left border-b border-border-color">
              <div class="relative inline-block">
                <select class="appearance-none cursor-pointer rounded-full font-bold text-xs bg-transparent py-1 pl-3 pr-8 focus:outline-none border"
                        [value]="order.status"
                        (change)="onStatusChange($event, order)"
                        [ngClass]="{
                          'text-text-secondary border-text-secondary bg-text-secondary/20': order.status === 'Pedido Realizado' || order.status === 'Pago Confirmado',
                          'text-warning border-warning bg-warning/20': order.status === 'Procesando',
                          'text-primary-accent border-primary-accent bg-primary-accent/20': order.status === 'Enviado',
                          'text-success border-success bg-success/20': order.status === 'Entregado',
                          'text-danger border-danger bg-danger/20': order.status === 'Cancelado'
                        }">
                  @for (status of statusOptions; track status) {
                    <option class="bg-dark-bg-secondary text-text-primary" [value]="status">{{ status }}</option>
                  }
                </select>
                <div class="pointer-events-none absolute inset-y-0 right-0 flex items-center px-2" [ngClass]="{
                    'text-text-secondary': order.status === 'Pedido Realizado' || order.status === 'Pago Confirmado',
                    'text-warning': order.status === 'Procesando',
                    'text-primary-accent': order.status === 'Enviado',
                    'text-success': order.status === 'Entregado',
                    'text-danger': order.status === 'Cancelado'
                  }">
                  <svg class="fill-current h-4 w-4" xmlns="http://www.w.org/2000/svg" viewBox="0 0 20 20"><path d="M9.293 12.95l.707.707L15.657 8l-1.414-1.414L10 10.828 5.757 6.586 4.343 8z"/></svg>
                </div>
              </div>
            </td>
            <td class="p-4 text-left border-b border-border-color">
              <a [routerLink]="['/admin/orders', order.id.replace('#', '')]" class="bg-transparent border-none text-text-secondary cursor-pointer text-lg p-2 transition-colors hover:text-primary-accent" title="Ver Detalles del Pedido">
                <i class="fas fa-eye"></i>
              </a>
            </td>
          </tr>
        } @empty {
          <tr>
            <td colspan="6" class="p-4 text-left border-b border-border-color py-8 text-text-secondary">No se encontraron pedidos.</td>
          </tr>
        }
      }
    </tbody>
  </table>
</div>
