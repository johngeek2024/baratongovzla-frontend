<header class="content-header">
  <h1>Gestión de Categorías</h1>
  <div class="header-actions">
    <button class="btn" (click)="openAddModal()">
      <i class="fas fa-plus"></i> Añadir Categoría
    </button>
  </div>
</header>

<div class="admin-table-container mt-8">
  <table class="admin-table">
    <thead>
      <tr><th>Nombre</th><th>Slug</th><th>Productos</th><th>Acciones</th></tr>
    </thead>
    <tbody>
      @for (category of categories(); track category.id) {
        <tr>
          <td class="font-semibold text-white">{{ category.name }}</td>
          <td>/{{ category.slug }}</td>
          <td>{{ category.productCount }}</td>
          <td class="action-buttons">
            <button (click)="openEditModal(category)"><i class="fas fa-edit"></i></button>
            <button class="delete-btn" (click)="openDeleteConfirmation(category)"><i class="fas fa-trash"></i></button>
          </td>
        </tr>
      } @empty {
        <tr><td colspan="4" class="text-center py-8 text-text-secondary">No se encontraron categorías.</td></tr>
      }
    </tbody>
  </table>
</div>

<app-modal [isOpen]="isFormModalOpen" [title]="categoryToEdit() ? 'Editar Categoría' : 'Añadir Categoría'" (close)="closeFormModal()">
  <app-category-form
    [isSaving]="isSaving"
    [categoryToEdit]="categoryToEdit()"
    (save)="handleSaveCategory($event)"
    (cancel)="closeFormModal()"></app-category-form>
</app-modal>

<app-modal [isOpen]="isDeleteModalOpen" title="Confirmar Eliminación" (close)="closeDeleteConfirmation()">
  <p class="text-text-secondary">
    ¿Estás seguro de que deseas eliminar la categoría
    <strong class="text-white">{{ categoryToDelete()?.name }}</strong>?
  </p>
  <div modal-footer class="flex justify-end gap-4">
    <button class="btn btn-secondary" (click)="closeDeleteConfirmation()">Cancelar</button>
    <button class="btn !bg-danger !text-white" (click)="handleDeleteCategory()" [disabled]="isSaving()">
      @if (isSaving()) {
        <i class="fas fa-spinner animate-spin mr-2"></i>
        <span>Eliminando...</span>
      } @else {
        <span>Sí, Eliminar</span>
      }
    </button>
  </div>
</app-modal>

<style>
  .content-header { @apply flex justify-between items-center; }
  .content-header h1 { @apply text-2xl sm:text-3xl font-bold; }
  .btn { @apply bg-primary-accent text-dark-bg border-none px-6 py-2.5 rounded-lg font-bold cursor-pointer transition-all duration-200 inline-flex items-center gap-2; }
  .btn:hover { @apply -translate-y-0.5 shadow-lg shadow-primary-accent/20; }
  .admin-table-container { @apply bg-dark-bg-secondary border border-border-color rounded-xl overflow-x-auto; }
  .admin-table { @apply w-full border-collapse; }
  .admin-table th, .admin-table td { @apply p-4 text-left border-b border-border-color; }
  .admin-table th { @apply text-sm font-semibold text-text-secondary uppercase; }
  .admin-table tbody tr:last-child td { @apply border-none; }
  .action-buttons button { @apply bg-transparent border-none text-text-secondary cursor-pointer text-lg p-2 transition-colors duration-200; }
  .action-buttons button:hover { @apply text-primary-accent; }
  .action-buttons .delete-btn:hover { @apply text-danger; }
</style>
