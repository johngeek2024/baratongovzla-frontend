<header class="flex justify-between items-center">
  <h1 class="text-2xl sm:text-3xl font-bold">Gestión de Categorías</h1>
  <div class="header-actions">
    <button class="bg-primary-accent text-dark-bg border-none px-6 py-2.5 rounded-lg font-bold cursor-pointer transition-all duration-200 inline-flex items-center gap-2 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-primary-accent/20" (click)="openAddModal()">
      <i class="fas fa-plus"></i> Añadir Categoría
    </button>
  </div>
</header>

<div class="bg-dark-bg-secondary border border-border-color rounded-xl overflow-x-auto mt-8">
  <table class="w-full border-collapse">
    <thead>
      <tr>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase">Nombre</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase">Slug</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase">Productos</th>
        <th class="p-4 text-left border-b border-border-color text-sm font-semibold text-text-secondary uppercase">Acciones</th>
      </tr>
    </thead>
    <tbody>
      @for (category of categories(); track category.id) {
        <tr class="last:border-none">
          <td class="p-4 text-left border-b border-border-color font-semibold text-white">{{ category.name }}</td>
          <td class="p-4 text-left border-b border-border-color">/{{ category.slug }}</td>
          <td class="p-4 text-left border-b border-border-color">{{ category.productCount }}</td>
          <td class="p-4 text-left border-b border-border-color">
            <button class="bg-transparent border-none text-text-secondary cursor-pointer text-lg p-2 transition-colors duration-200 hover:text-primary-accent" (click)="openEditModal(category)"><i class="fas fa-edit"></i></button>
            <button class="bg-transparent border-none text-text-secondary cursor-pointer text-lg p-2 transition-colors duration-200 hover:text-danger" (click)="openDeleteConfirmation(category)"><i class="fas fa-trash"></i></button>
          </td>
        </tr>
      } @empty {
        <tr><td colspan="4" class="text-center py-8 text-text-secondary p-4 border-b border-border-color">No se encontraron categorías.</td></tr>
      }
    </tbody>
  </table>
</div>

<app-modal [isOpen]="isFormModalOpen" [title]="categoryToEdit() ? 'Editar Categoría' : 'Añadir Categoría'" (close)="closeFormModal()">
  <app-category-form
    [isSaving]="isSaving"
    [categoryToEdit]="categoryToEdit()"
    (save)="handleSaveCategory($event)"
    (cancel)="closeFormModal()"></app-category-form>
</app-modal>

<app-modal [isOpen]="isDeleteModalOpen" title="Confirmar Eliminación" (close)="closeDeleteConfirmation()">
  <p class="text-text-secondary">
    ¿Estás seguro de que deseas eliminar la categoría
    <strong class="text-white">{{ categoryToDelete()?.name }}</strong>?
  </p>
  <div modal-footer class="flex justify-end gap-4">
    <button class="bg-border-color text-text-primary px-6 py-2.5 rounded-lg font-bold cursor-pointer transition-all duration-200 inline-flex items-center gap-2 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-primary-accent/20" (click)="closeDeleteConfirmation()">Cancelar</button>
    <button class="text-dark-bg border-none px-6 py-2.5 rounded-lg font-bold cursor-pointer transition-all duration-200 inline-flex items-center gap-2 hover:-translate-y-0.5 hover:shadow-lg hover:shadow-primary-accent/20 !bg-danger" (click)="handleDeleteCategory()" [disabled]="isSaving()">
      @if (isSaving()) {
        <i class="fas fa-spinner animate-spin mr-2"></i>
        <span>Eliminando...</span>
      } @else {
        <span>Sí, Eliminar</span>
      }
    </button>
  </div>
</app-modal>
